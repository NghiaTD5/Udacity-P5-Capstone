{"ast":null,"code":"import _defineProperty from \"D:/NghiaTD5/new_clone/p5_udacity/final/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _toConsumableArray from \"D:/NghiaTD5/new_clone/p5_udacity/final/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _asyncToGenerator from \"D:/NghiaTD5/new_clone/p5_udacity/final/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"D:/NghiaTD5/new_clone/p5_udacity/final/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"D:/NghiaTD5/new_clone/p5_udacity/final/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"D:/NghiaTD5/new_clone/p5_udacity/final/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"D:/NghiaTD5/new_clone/p5_udacity/final/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nvar _jsxFileName = \"D:\\\\NghiaTD5\\\\new_clone\\\\p5_udacity\\\\final\\\\client\\\\src\\\\components\\\\Todos.tsx\";\nimport _regeneratorRuntime from \"D:\\\\NghiaTD5\\\\new_clone\\\\p5_udacity\\\\final\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport dateFormat from \"dateformat\";\nimport update from \"immutability-helper\";\nimport * as React from \"react\";\nimport { Button, Checkbox, Divider, Grid, Header, Icon, Input, Image, Loader, Popup, Table } from \"semantic-ui-react\";\nimport { createTodo, deleteTodo, download, getDownloadUrl, getTodos, patchTodo, removeAttachment } from \"../api/todos-api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var Todos = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(Todos, _React$PureComponent);\n\n  var _super = _createSuper(Todos);\n\n  function Todos() {\n    var _this;\n\n    _classCallCheck(this, Todos);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      todos: [],\n      newTodoName: \"\",\n      loadingTodos: true\n    };\n\n    _this.handleNameChange = function (event) {\n      _this.setState({\n        newTodoName: event.target.value\n      });\n    };\n\n    _this.onEditButtonClick = function (todoId) {\n      _this.props.history.push(\"/todos/\".concat(todoId, \"/edit\"));\n    };\n\n    _this.onRemoveAttachmentButtonClick = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(todo) {\n        var todoId, attachmentUrl, attachmentUrlParts, length, s3Key, updatedTodos;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                todoId = todo.todoId;\n\n                if (!todo.attachmentUrl) {\n                  _context.next = 12;\n                  break;\n                }\n\n                attachmentUrl = todo.attachmentUrl;\n                attachmentUrlParts = attachmentUrl.split(\"/\");\n                length = attachmentUrlParts.length;\n                s3Key = \"\".concat(attachmentUrlParts[length - 2], \"/\").concat(attachmentUrlParts[length - 1]);\n                _context.next = 9;\n                return removeAttachment(_this.props.auth.getIdToken(), todoId, s3Key);\n\n              case 9:\n                //\n                updatedTodos = [];\n\n                _this.state.todos.forEach(function (todo) {\n                  if (todo.todoId === todoId) {\n                    todo.attachmentUrl = \"\";\n                    updatedTodos.push(todo);\n                  } else {\n                    updatedTodos.push(todo);\n                  }\n                });\n\n                _this.setState({\n                  todos: updatedTodos\n                });\n\n              case 12:\n                _context.next = 17;\n                break;\n\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](0);\n                console.log(\"Failed to remove attachment..!\");\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 14]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.onDownloadAttachment = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id) {\n        var todo, attachmentUrl, attachmentUrlParts, length, s3Key, downloadUrl;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                todo = _this.state.todos.find(function (todo) {\n                  return todo.todoId === id;\n                });\n\n                if (!(todo !== null && todo !== void 0 && todo.attachmentUrl)) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                attachmentUrl = todo.attachmentUrl;\n                attachmentUrlParts = attachmentUrl.split(\"/\");\n                length = attachmentUrlParts.length;\n                s3Key = \"\".concat(attachmentUrlParts[length - 2], \"/\").concat(attachmentUrlParts[length - 1]);\n                _context2.next = 8;\n                return getDownloadUrl(_this.props.auth.getIdToken(), s3Key);\n\n              case 8:\n                downloadUrl = _context2.sent;\n                console.log(\"Download URL: \", downloadUrl);\n                download(downloadUrl, attachmentUrlParts[length - 1]);\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.onTodoCreate = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event) {\n        var dueDate, newTodo;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                dueDate = _this.calculateDueDate();\n\n                if (!(_this.state.newTodoName.length > 0)) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                _context3.next = 5;\n                return createTodo(_this.props.auth.getIdToken(), {\n                  name: _this.state.newTodoName,\n                  dueDate: dueDate\n                });\n\n              case 5:\n                newTodo = _context3.sent;\n\n                _this.setState({\n                  todos: [].concat(_toConsumableArray(_this.state.todos), [newTodo]),\n                  newTodoName: \"\"\n                });\n\n                _context3.next = 10;\n                break;\n\n              case 9:\n                alert(\"Task name can't be empty\");\n\n              case 10:\n                _context3.next = 15;\n                break;\n\n              case 12:\n                _context3.prev = 12;\n                _context3.t0 = _context3[\"catch\"](0);\n                alert(\"Todo creation failed\");\n\n              case 15:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[0, 12]]);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.onTodoDelete = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(todo) {\n        var id, attachmentUrl, attachmentUrlParts, length, s3Key;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                id = todo.todoId;\n\n                if (!(todo !== null && todo !== void 0 && todo.attachmentUrl)) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                attachmentUrl = todo.attachmentUrl;\n                attachmentUrlParts = attachmentUrl.split(\"/\");\n                length = attachmentUrlParts.length;\n                s3Key = \"\".concat(attachmentUrlParts[length - 2], \"/\").concat(attachmentUrlParts[length - 1]);\n                _context4.next = 9;\n                return deleteTodo(_this.props.auth.getIdToken(), id, s3Key);\n\n              case 9:\n                _this.setState({\n                  todos: _this.state.todos.filter(function (todo) {\n                    return todo.todoId !== id;\n                  })\n                });\n\n              case 10:\n                _context4.next = 15;\n                break;\n\n              case 12:\n                _context4.prev = 12;\n                _context4.t0 = _context4[\"catch\"](0);\n                alert(\"Todo deletion failed\");\n\n              case 15:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, null, [[0, 12]]);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.onTodoCheck = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(pos) {\n        var todo;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                todo = _this.state.todos[pos];\n                _context5.next = 4;\n                return patchTodo(_this.props.auth.getIdToken(), todo.todoId, {\n                  name: todo.name,\n                  dueDate: todo.dueDate,\n                  done: !todo.done\n                });\n\n              case 4:\n                _this.setState({\n                  todos: update(_this.state.todos, _defineProperty({}, pos, {\n                    done: {\n                      $set: !todo.done\n                    }\n                  }))\n                });\n\n                _context5.next = 10;\n                break;\n\n              case 7:\n                _context5.prev = 7;\n                _context5.t0 = _context5[\"catch\"](0);\n                alert(\"Update todo failed!\");\n\n              case 10:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, null, [[0, 7]]);\n      }));\n\n      return function (_x5) {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    return _this;\n  }\n\n  _createClass(Todos, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n        var todos;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.prev = 0;\n                _context6.next = 3;\n                return getTodos(this.props.auth.getIdToken());\n\n              case 3:\n                todos = _context6.sent;\n                this.setState({\n                  todos: todos,\n                  loadingTodos: false\n                });\n                _context6.next = 10;\n                break;\n\n              case 7:\n                _context6.prev = 7;\n                _context6.t0 = _context6[\"catch\"](0);\n                alert(\"Failed to fetch todos: \".concat(_context6.t0));\n\n              case 10:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[0, 7]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Header, {\n          as: \"h1\",\n          children: \"TODOs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 9\n        }, this), this.renderCreateTodoInput(), this.state.todos.length > 0 && this.renderTodos()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"renderCreateTodoInput\",\n    value: function renderCreateTodoInput() {\n      return /*#__PURE__*/_jsxDEV(Grid.Row, {\n        children: [/*#__PURE__*/_jsxDEV(Grid.Column, {\n          width: 16,\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            action: {\n              color: \"teal\",\n              labelPosition: \"left\",\n              icon: \"add\",\n              content: \"New task\",\n              onClick: this.onTodoCreate\n            },\n            fluid: true,\n            actionPosition: \"left\",\n            placeholder: \"To change the world...\",\n            onChange: this.handleNameChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Grid.Column, {\n          width: 16,\n          children: /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"renderTodos\",\n    value: function renderTodos() {\n      if (this.state.loadingTodos) {\n        return this.renderLoading();\n      }\n\n      return this.renderTodosList();\n    }\n  }, {\n    key: \"renderLoading\",\n    value: function renderLoading() {\n      return /*#__PURE__*/_jsxDEV(Grid.Row, {\n        children: /*#__PURE__*/_jsxDEV(Loader, {\n          indeterminate: true,\n          active: true,\n          inline: \"centered\",\n          children: \"Loading TODOs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"renderTodosList\",\n    value: function renderTodosList() {\n      var _this2 = this;\n\n      return /*#__PURE__*/_jsxDEV(Table, {\n        celled: true,\n        padded: true,\n        children: [/*#__PURE__*/_jsxDEV(Table.Header, {\n          children: /*#__PURE__*/_jsxDEV(Table.Row, {\n            children: [/*#__PURE__*/_jsxDEV(Table.HeaderCell, {\n              textAlign: \"center\",\n              children: \"Done\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Table.HeaderCell, {\n              textAlign: \"center\",\n              children: \"Task Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Table.HeaderCell, {\n              textAlign: \"center\",\n              children: \"Attachments\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Table.HeaderCell, {\n              textAlign: \"center\",\n              children: \"Due Date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Table.HeaderCell, {\n              textAlign: \"center\",\n              children: \"Actions\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Table.Body, {\n          children: this.state.todos.map(function (todo, pos) {\n            return /*#__PURE__*/_jsxDEV(Table.Row, {\n              children: [/*#__PURE__*/_jsxDEV(Table.Cell, {\n                textAlign: \"center\",\n                width: 1,\n                children: /*#__PURE__*/_jsxDEV(Popup, {\n                  content: \"Mark completed\",\n                  trigger: /*#__PURE__*/_jsxDEV(Checkbox, {\n                    onChange: function onChange() {\n                      return _this2.onTodoCheck(pos);\n                    },\n                    checked: todo.done\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 249,\n                    columnNumber: 23\n                  }, _this2)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 19\n                }, _this2)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 17\n              }, _this2), /*#__PURE__*/_jsxDEV(Table.Cell, {\n                width: 7,\n                children: [\" \", todo.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 17\n              }, _this2), /*#__PURE__*/_jsxDEV(Table.Cell, {\n                width: 3,\n                children: [\" \", todo.attachmentUrl && /*#__PURE__*/_jsxDEV(Image, {\n                  size: \"tiny\",\n                  src: todo.attachmentUrl\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 260,\n                  columnNumber: 21\n                }, _this2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 17\n              }, _this2), /*#__PURE__*/_jsxDEV(Table.Cell, {\n                width: 2,\n                children: [\" \", todo.dueDate]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 17\n              }, _this2), /*#__PURE__*/_jsxDEV(Table.Cell, {\n                width: 3,\n                textAlign: \"center\",\n                children: [\" \", todo.attachmentUrl && /*#__PURE__*/_jsxDEV(Popup, {\n                  content: \"Download\",\n                  trigger: /*#__PURE__*/_jsxDEV(Button, {\n                    icon: true,\n                    color: \"blue\",\n                    onClick: function onClick() {\n                      return _this2.onDownloadAttachment(todo.todoId);\n                    },\n                    children: /*#__PURE__*/_jsxDEV(Icon, {\n                      name: \"download\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 275,\n                      columnNumber: 27\n                    }, _this2)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 270,\n                    columnNumber: 25\n                  }, _this2)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 267,\n                  columnNumber: 21\n                }, _this2), todo.attachmentUrl && /*#__PURE__*/_jsxDEV(Popup, {\n                  content: \"Remove\",\n                  trigger: /*#__PURE__*/_jsxDEV(Button, {\n                    icon: true,\n                    color: \"yellow\",\n                    onClick: function onClick() {\n                      return _this2.onRemoveAttachmentButtonClick(todo);\n                    },\n                    children: /*#__PURE__*/_jsxDEV(Icon, {\n                      name: \"unlinkify\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 291,\n                      columnNumber: 27\n                    }, _this2)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 284,\n                    columnNumber: 25\n                  }, _this2)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 21\n                }, _this2), /*#__PURE__*/_jsxDEV(Popup, {\n                  content: \"Update\",\n                  trigger: /*#__PURE__*/_jsxDEV(Button, {\n                    icon: true,\n                    color: \"red\",\n                    onClick: function onClick() {\n                      return _this2.onEditButtonClick(todo.todoId);\n                    },\n                    children: /*#__PURE__*/_jsxDEV(Icon, {\n                      name: \"pencil\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 304,\n                      columnNumber: 25\n                    }, _this2)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 299,\n                    columnNumber: 23\n                  }, _this2)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 296,\n                  columnNumber: 19\n                }, _this2), /*#__PURE__*/_jsxDEV(Popup, {\n                  content: \"Delete\",\n                  trigger: /*#__PURE__*/_jsxDEV(Button, {\n                    icon: true,\n                    color: \"grey\",\n                    onClick: function onClick() {\n                      return _this2.onTodoDelete(todo);\n                    },\n                    children: /*#__PURE__*/_jsxDEV(Icon, {\n                      name: \"delete\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 316,\n                      columnNumber: 25\n                    }, _this2)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 311,\n                    columnNumber: 23\n                  }, _this2)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 19\n                }, _this2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 17\n              }, _this2)]\n            }, todo.todoId, true, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 15\n            }, _this2);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 7\n      }, this);\n    }\n  }, {\n    key: \"calculateDueDate\",\n    value: function calculateDueDate() {\n      var date = new Date();\n      date.setDate(date.getDate() + 7);\n      return dateFormat(date, \"yyyy-mm-dd\");\n    }\n  }]);\n\n  return Todos;\n}(React.PureComponent);","map":{"version":3,"names":["dateFormat","update","React","Button","Checkbox","Divider","Grid","Header","Icon","Input","Image","Loader","Popup","Table","createTodo","deleteTodo","download","getDownloadUrl","getTodos","patchTodo","removeAttachment","Todos","state","todos","newTodoName","loadingTodos","handleNameChange","event","setState","target","value","onEditButtonClick","todoId","props","history","push","onRemoveAttachmentButtonClick","todo","attachmentUrl","attachmentUrlParts","split","length","s3Key","auth","getIdToken","updatedTodos","forEach","console","log","onDownloadAttachment","id","find","downloadUrl","onTodoCreate","dueDate","calculateDueDate","name","newTodo","alert","onTodoDelete","filter","onTodoCheck","pos","done","$set","renderCreateTodoInput","renderTodos","color","labelPosition","icon","content","onClick","renderLoading","renderTodosList","map","date","Date","setDate","getDate","PureComponent"],"sources":["D:/NghiaTD5/new_clone/p5_udacity/final/client/src/components/Todos.tsx"],"sourcesContent":["import dateFormat from \"dateformat\";\r\nimport { History } from \"history\";\r\nimport update from \"immutability-helper\";\r\nimport * as React from \"react\";\r\nimport {\r\n  Button,\r\n  Checkbox,\r\n  Divider,\r\n  Grid,\r\n  Header,\r\n  Icon,\r\n  Input,\r\n  Image,\r\n  Loader,\r\n  Popup,\r\n  Table,\r\n} from \"semantic-ui-react\";\r\n\r\nimport {\r\n  createTodo,\r\n  deleteTodo,\r\n  download,\r\n  getDownloadUrl,\r\n  getTodos,\r\n  patchTodo,\r\n  removeAttachment,\r\n} from \"../api/todos-api\";\r\nimport Auth from \"../auth/Auth\";\r\nimport { Todo } from \"../types/Todo\";\r\n\r\ninterface TodosProps {\r\n  auth: Auth;\r\n  history: History;\r\n}\r\n\r\ninterface TodosState {\r\n  todos: Todo[];\r\n  newTodoName: string;\r\n  loadingTodos: boolean;\r\n}\r\n\r\nexport class Todos extends React.PureComponent<TodosProps, TodosState> {\r\n  state: TodosState = {\r\n    todos: [],\r\n    newTodoName: \"\",\r\n    loadingTodos: true,\r\n  };\r\n\r\n  handleNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    this.setState({ newTodoName: event.target.value });\r\n  };\r\n\r\n  onEditButtonClick = (todoId: string) => {\r\n    this.props.history.push(`/todos/${todoId}/edit`);\r\n  };\r\n\r\n  onRemoveAttachmentButtonClick = async (todo: Todo) => {\r\n    try {\r\n      const todoId = todo.todoId;\r\n      if (todo.attachmentUrl) {\r\n        const attachmentUrl = todo.attachmentUrl;\r\n        const attachmentUrlParts = attachmentUrl.split(\"/\");\r\n        const length = attachmentUrlParts.length;\r\n        const s3Key = `${attachmentUrlParts[length - 2]}/${\r\n          attachmentUrlParts[length - 1]\r\n        }`;\r\n        await removeAttachment(this.props.auth.getIdToken(), todoId, s3Key);\r\n        //\r\n        let updatedTodos: Todo[] = [];\r\n        this.state.todos.forEach(function (todo) {\r\n          if (todo.todoId === todoId) {\r\n            todo.attachmentUrl = \"\";\r\n            updatedTodos.push(todo);\r\n          } else {\r\n            updatedTodos.push(todo);\r\n          }\r\n        });\r\n        this.setState({\r\n          todos: updatedTodos,\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.log(\"Failed to remove attachment..!\");\r\n    }\r\n  };\r\n\r\n  onDownloadAttachment = async (id: string) => {\r\n    const todo = this.state.todos.find((todo) => todo.todoId === id);\r\n    if (todo?.attachmentUrl) {\r\n      const attachmentUrl = todo.attachmentUrl;\r\n      const attachmentUrlParts = attachmentUrl.split(\"/\");\r\n      const length = attachmentUrlParts.length;\r\n      const s3Key = `${attachmentUrlParts[length - 2]}/${\r\n        attachmentUrlParts[length - 1]\r\n      }`;\r\n\r\n      const downloadUrl = await getDownloadUrl(\r\n        this.props.auth.getIdToken(),\r\n        s3Key\r\n      );\r\n      console.log(\"Download URL: \", downloadUrl);\r\n      download(downloadUrl, attachmentUrlParts[length - 1]);\r\n    }\r\n  };\r\n\r\n  onTodoCreate = async (event: React.ChangeEvent<HTMLButtonElement>) => {\r\n    try {\r\n      const dueDate = this.calculateDueDate();\r\n      if (this.state.newTodoName.length > 0) {\r\n        const newTodo = await createTodo(this.props.auth.getIdToken(), {\r\n          name: this.state.newTodoName,\r\n          dueDate,\r\n        });\r\n        this.setState({\r\n          todos: [...this.state.todos, newTodo],\r\n          newTodoName: \"\",\r\n        });\r\n      } else {\r\n        alert(\"Task name can't be empty\");\r\n      }\r\n    } catch {\r\n      alert(\"Todo creation failed\");\r\n    }\r\n  };\r\n\r\n  onTodoDelete = async (todo: Todo) => {\r\n    try {\r\n      const id = todo.todoId;\r\n      if (todo?.attachmentUrl) {\r\n        const attachmentUrl = todo.attachmentUrl;\r\n        const attachmentUrlParts = attachmentUrl.split(\"/\");\r\n        const length = attachmentUrlParts.length;\r\n        const s3Key = `${attachmentUrlParts[length - 2]}/${\r\n          attachmentUrlParts[length - 1]\r\n        }`; \r\n        await deleteTodo(this.props.auth.getIdToken(), id, s3Key);\r\n        this.setState({\r\n          todos: this.state.todos.filter((todo) => todo.todoId !== id),\r\n        })\r\n      }\r\n    } catch {\r\n      alert(\"Todo deletion failed\");\r\n    }\r\n  }\r\n\r\n  onTodoCheck = async (pos: number) => {\r\n    try {\r\n      const todo = this.state.todos[pos];\r\n      await patchTodo(this.props.auth.getIdToken(), todo.todoId, {\r\n        name: todo.name,\r\n        dueDate: todo.dueDate,\r\n        done: !todo.done,\r\n      });\r\n      this.setState({\r\n        todos: update(this.state.todos, {\r\n          [pos]: { done: { $set: !todo.done } },\r\n        }),\r\n      });\r\n    } catch {\r\n      alert(\"Update todo failed!\");\r\n    }\r\n  };\r\n\r\n  async componentDidMount() {\r\n    try {\r\n      const todos = await getTodos(this.props.auth.getIdToken());\r\n      this.setState({\r\n        todos,\r\n        loadingTodos: false,\r\n      });\r\n    } catch (e) {\r\n      alert(`Failed to fetch todos: ${e}`);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Header as=\"h1\">TODOs</Header>\r\n        {this.renderCreateTodoInput()}\r\n        {this.state.todos.length > 0 && this.renderTodos()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderCreateTodoInput() {\r\n    return (\r\n      <Grid.Row>\r\n        <Grid.Column width={16}>\r\n          <Input\r\n            action={{\r\n              color: \"teal\",\r\n              labelPosition: \"left\",\r\n              icon: \"add\",\r\n              content: \"New task\",\r\n              onClick: this.onTodoCreate,\r\n            }}\r\n            fluid\r\n            actionPosition=\"left\"\r\n            placeholder=\"To change the world...\"\r\n            onChange={this.handleNameChange}\r\n          />\r\n        </Grid.Column>\r\n        <Grid.Column width={16}>\r\n          <Divider />\r\n        </Grid.Column>\r\n      </Grid.Row>\r\n    );\r\n  }\r\n\r\n  renderTodos() {\r\n    if (this.state.loadingTodos) {\r\n      return this.renderLoading();\r\n    }\r\n\r\n    return this.renderTodosList();\r\n  }\r\n\r\n  renderLoading() {\r\n    return (\r\n      <Grid.Row>\r\n        <Loader indeterminate active inline=\"centered\">\r\n          Loading TODOs\r\n        </Loader>\r\n      </Grid.Row>\r\n    );\r\n  }\r\n\r\n  renderTodosList() {\r\n    return (\r\n      <Table celled padded>\r\n        <Table.Header>\r\n          <Table.Row>\r\n            <Table.HeaderCell textAlign=\"center\">Done</Table.HeaderCell>\r\n            <Table.HeaderCell textAlign=\"center\">Task Name</Table.HeaderCell>\r\n            <Table.HeaderCell textAlign=\"center\">Attachments</Table.HeaderCell>\r\n            <Table.HeaderCell textAlign=\"center\">Due Date</Table.HeaderCell>\r\n            <Table.HeaderCell textAlign=\"center\">Actions</Table.HeaderCell>\r\n          </Table.Row>\r\n        </Table.Header>\r\n        <Table.Body>\r\n          {this.state.todos.map((todo, pos) => {\r\n            return (\r\n              <Table.Row key={todo.todoId}>\r\n                <Table.Cell textAlign=\"center\" width={1}>\r\n                  <Popup\r\n                    content=\"Mark completed\"\r\n                    trigger={\r\n                      <Checkbox\r\n                        onChange={() => this.onTodoCheck(pos)}\r\n                        checked={todo.done}\r\n                      />\r\n                    }\r\n                  />\r\n                </Table.Cell>\r\n                <Table.Cell width={7}> {todo.name}</Table.Cell>\r\n                <Table.Cell width={3}>\r\n                  {\" \"}\r\n                  {todo.attachmentUrl && (\r\n                    <Image size=\"tiny\" src={todo.attachmentUrl} />\r\n                  )}\r\n                </Table.Cell>\r\n                <Table.Cell width={2}> {todo.dueDate}</Table.Cell>\r\n                <Table.Cell width={3} textAlign=\"center\">\r\n                  {\" \"}\r\n                  {todo.attachmentUrl && (\r\n                    <Popup\r\n                      content=\"Download\"\r\n                      trigger={\r\n                        <Button\r\n                          icon\r\n                          color=\"blue\"\r\n                          onClick={() => this.onDownloadAttachment(todo.todoId)}\r\n                        >\r\n                          <Icon name=\"download\" />\r\n                        </Button>\r\n                      }\r\n                    />\r\n                  )}\r\n                  {todo.attachmentUrl && (\r\n                    <Popup\r\n                      content=\"Remove\"\r\n                      trigger={\r\n                        <Button\r\n                          icon\r\n                          color=\"yellow\"\r\n                          onClick={() =>\r\n                            this.onRemoveAttachmentButtonClick(todo)\r\n                          }\r\n                        >\r\n                          <Icon name=\"unlinkify\" />\r\n                        </Button>\r\n                      }\r\n                    />\r\n                  )}\r\n                  <Popup\r\n                    content=\"Update\"\r\n                    trigger={\r\n                      <Button\r\n                        icon\r\n                        color=\"red\"\r\n                        onClick={() => this.onEditButtonClick(todo.todoId)}\r\n                      >\r\n                        <Icon name=\"pencil\" />\r\n                      </Button>\r\n                    }\r\n                  />\r\n                  <Popup\r\n                    content=\"Delete\"\r\n                    trigger={\r\n                      <Button\r\n                        icon\r\n                        color=\"grey\"\r\n                        onClick={() => this.onTodoDelete(todo)}\r\n                      >\r\n                        <Icon name=\"delete\" />\r\n                      </Button>\r\n                    }\r\n                  />\r\n                </Table.Cell>\r\n              </Table.Row>\r\n            );\r\n          })}\r\n        </Table.Body>\r\n      </Table>\r\n    );\r\n  }\r\n\r\n  calculateDueDate(): string {\r\n    const date = new Date();\r\n    date.setDate(date.getDate() + 7);\r\n\r\n    return dateFormat(date, \"yyyy-mm-dd\") as string;\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}